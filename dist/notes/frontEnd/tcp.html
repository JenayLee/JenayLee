<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TCP协议 | Jenay Lee</title>
    <meta name="description" content="Jenay&#39;s blog">
    <link rel="shortcut icon" type="image/x-icon" href="/JenayLee/images/logo.ico">
    
    <link rel="preload" href="/JenayLee/assets/css/0.styles.fbf7ff69.css" as="style"><link rel="preload" href="/JenayLee/assets/js/app.0b41792d.js" as="script"><link rel="preload" href="/JenayLee/assets/js/17.fe1b6cf8.js" as="script"><link rel="prefetch" href="/JenayLee/assets/js/10.c45ce98c.js"><link rel="prefetch" href="/JenayLee/assets/js/11.a370caa2.js"><link rel="prefetch" href="/JenayLee/assets/js/12.1d2cd8e8.js"><link rel="prefetch" href="/JenayLee/assets/js/13.26dde88f.js"><link rel="prefetch" href="/JenayLee/assets/js/14.c023a1f5.js"><link rel="prefetch" href="/JenayLee/assets/js/15.287d77ca.js"><link rel="prefetch" href="/JenayLee/assets/js/16.7f097621.js"><link rel="prefetch" href="/JenayLee/assets/js/18.5aa963cc.js"><link rel="prefetch" href="/JenayLee/assets/js/19.f0c3d88c.js"><link rel="prefetch" href="/JenayLee/assets/js/2.e4f0e558.js"><link rel="prefetch" href="/JenayLee/assets/js/20.bc5d540f.js"><link rel="prefetch" href="/JenayLee/assets/js/3.7e9ddeec.js"><link rel="prefetch" href="/JenayLee/assets/js/4.ce52c57f.js"><link rel="prefetch" href="/JenayLee/assets/js/5.02a62bd5.js"><link rel="prefetch" href="/JenayLee/assets/js/6.32ad42f2.js"><link rel="prefetch" href="/JenayLee/assets/js/7.9cb18285.js"><link rel="prefetch" href="/JenayLee/assets/js/8.59beca3f.js"><link rel="prefetch" href="/JenayLee/assets/js/9.758c4a01.js">
    <link rel="stylesheet" href="/JenayLee/assets/css/0.styles.fbf7ff69.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/JenayLee/" class="home-link router-link-active"><!----> <span class="site-name">Jenay Lee</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/JenayLee/dist/notes/frontEnd/checking.html" class="nav-link">Notes</a></div><div class="nav-item"><a href="/JenayLee/dist/about/" class="nav-link">About</a></div><div class="nav-item"><a href="https://github.com/JenayLee" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/JenayLee/dist/notes/frontEnd/checking.html" class="nav-link">Notes</a></div><div class="nav-item"><a href="/JenayLee/dist/about/" class="nav-link">About</a></div><div class="nav-item"><a href="https://github.com/JenayLee" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>前端</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/JenayLee/dist/notes/frontEnd/checking.html" class="sidebar-link">自检清单</a></li><li><a href="/JenayLee/dist/notes/frontEnd/promise.html" class="sidebar-link">Promise</a></li><li><a href="/JenayLee/dist/notes/frontEnd/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/JenayLee/dist/notes/frontEnd/axios.html" class="sidebar-link">Axios</a></li><li><a href="/JenayLee/dist/notes/frontEnd/vue.html" class="sidebar-link">Vue</a></li><li><a href="/JenayLee/dist/notes/frontEnd/react.html" class="sidebar-link">React</a></li><li><a href="/JenayLee/dist/notes/frontEnd/angular.html" class="sidebar-link">Angular</a></li><li><a href="/JenayLee/dist/notes/frontEnd/mvvm.html" class="sidebar-link">MVVM</a></li><li><a href="/JenayLee/dist/notes/frontEnd/flutter.html" class="sidebar-link">Flutter</a></li><li><a href="/JenayLee/dist/notes/frontEnd/optimize.html" class="sidebar-link">优化</a></li><li><a href="/JenayLee/dist/notes/frontEnd/async.html" class="sidebar-link">异步编程</a></li><li><a href="/JenayLee/dist/notes/frontEnd/tcp.html" class="active sidebar-link">TCP协议</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/JenayLee/dist/notes/frontEnd/tcp.html#三次握手" class="sidebar-link">三次握手</a></li><li class="sidebar-sub-header"><a href="/JenayLee/dist/notes/frontEnd/tcp.html#四次挥手" class="sidebar-link">四次挥手</a></li><li class="sidebar-sub-header"><a href="/JenayLee/dist/notes/frontEnd/tcp.html#网页从输入网址到渲染完成经历了哪些过程" class="sidebar-link">网页从输入网址到渲染完成经历了哪些过程</a></li></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>后端</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/JenayLee/dist/notes/backEnd/C.html" class="sidebar-link">Java</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="tcp协议">TCP协议</h1> <p>TCP(Transmission control protocal)，传输控制协议，即机器与机器间传输信息的基础协议。</p> <h2 id="三次握手">三次握手</h2> <h4 id="第一次握手">第一次握手</h4> <p>TCP协议中，服务器对新的客户端都会置于Listen(等待响应)状态。客户端向服务器发送报文，发出请求SYN=1，同时选择一个初始序号seq=x(SYN是synchronization同步的简称，seq为sequcence序号的缩写)。这时，客户端的状态更改为SYN-SENT(synchronization_sent同步已发送)状态。这就是&quot;第一次握手&quot;。</p> <h4 id="第二次握手">第二次握手</h4> <p>服务器对客户端发送的同步请求SYN=1和具体信息seq=x做出响应，状态由Listen变为SYNC_RCVD(synchronization_received同步已收到)。当服务器收到请求报文，会向客户端发出确认报文。SYN=1，ACK=1，ack=x+1，同时发送序号为seq=y(ACK是acknowledgement确认的简称，小写ack是确认编号)。客户端此时的状态为established(建立连接)，此为&quot;第二次握手&quot;。</p> <h4 id="第三次握手">第三次握手</h4> <p>在客户端收到服务端发送的TCP建立验证请求后，客户端向服务器给出确认。返回服务器ACK=1，确认编号ack=y+1，在自己的序号上加上seq=x+1。服务端状态此时变为established，此为&quot;第三次握手&quot;。</p> <p><img src="/JenayLee/images/tcp_1.jpg" alt="tcp"></p> <h2 id="四次挥手">四次挥手</h2> <h4 id="第一次挥手">第一次挥手</h4> <p>客户端进程发出连接释放报文，并停止发送数据，设置报文FIN=1，其序列号为seq=u(FIN的意思是finish终结的意思)。此时客户端的状态是FIN-WAIT-1(终止等待1)。</p> <h4 id="第二次挥手">第二次挥手</h4> <p>服务器收到连接释放报文，发出确认报文，ACK=1，ack=u+1,seq=v。从第一次挥手到服务器发出响应，服务器处于CLOSE_WAIT状态。客户端进入FIN_WAIT-2状态。</p> <h4 id="第三次挥手">第三次挥手</h4> <p>服务器将最后的数据发送完毕后，就向客户端发送连接释放报文FIN=1,ACK=1,ack=u+1，服务器又发送了一些数据后截止，序列号为seq=w。服务器变为LAST_ACK(最终动作)状态，客户端进入TIME_WAIT阶段。</p> <h4 id="第四次挥手">第四次挥手</h4> <p>客户端收到服务器的连接释放报文后，必须发出确认，ACK=1，ack=w+1，而自己的序列号是seq=u+1。服务器随之进入CLOSED(关闭连接)状态。客户端等了2MSL(两次交谈响应时间那么长)之后进入CLOSED状态。</p> <p><img src="/JenayLee/images/tcp_2.jpg" alt="tcp"></p> <ul><li>每一次通讯，都带有seq序列码。每一次通讯，状态都会变更。</li> <li>SYN=1在握手阶段双方各发送一次。FIN=1在挥手阶段双方各发送一次。</li> <li>有确认码的时候ACK=1，必带有确认号ack。ack在上一条接收到的序号上+1。</li></ul> <h2 id="网页从输入网址到渲染完成经历了哪些过程">网页从输入网址到渲染完成经历了哪些过程</h2> <p>大致分为如下7步：</p> <ol><li><p>输入网址</p></li> <li><p>发送到DNS服务器，并获取域名对应的web服务器对应的IP地址</p></li> <li><p>与web服务器建立TCP连接</p></li> <li><p>浏览器向web服务器发送http请求</p></li> <li><p>web服务器响应请求，并返回指定url的数据（或错误信息，或重定向新的url地址）</p></li> <li><p>浏览器下载web服务器返回的数据及解析html源文件</p></li> <li><p>生成DOM树，解析css和js，渲染页面，直至显示完成</p></li></ol></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/JenayLee/dist/notes/frontEnd/async.html" class="prev">
          异步编程
        </a></span> <span class="next"><a href="/JenayLee/dist/notes/backEnd/C.html">
          Java
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/JenayLee/assets/js/app.0b41792d.js" defer></script><script src="/JenayLee/assets/js/17.fe1b6cf8.js" defer></script>
  </body>
</html>
